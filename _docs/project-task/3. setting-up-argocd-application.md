# Setting Up Argo CD Application - For the Project

This document provides a step-by-step guide on how to set up an Argo CD application for deploying and managing applications in the Helabooking infrastructure project.

## Important Points

- Argo CD is deployed into the `management` namespace using Helm charts.
- Argo CD will be using `helabooking-manifests` Git repository to sync application manifests.
- Kuztomize is used for managing different environment configurations.
- Each environment (dev, qa, staging, prod) will be set up as a separate Argo CD application in `helabooking-infra` repo under each environment folder.
- For the new environment, create a new overlay folder under `overlays` in `helabooking-manifests` repo and add the application specific Kustomize manifests.

## Steps to Set Up Argo CD Application

1. **Create Application using Terraform**:
   - Create a new Terraform file named `applications.tf` under the environment folder (e.g., `env-dev`, `env-qa`, etc.) in the `helabooking-infra` repository.
   - Define the Argo CD application required parameters such as application name, source repository, path, and destination namespace. (Example can be found in `on-prem/env-dev/applications.tf`)
   - Commit the changes into relevent environment branch to deploy automatically via Terraform.
2. **Access Argo CD UI**:
   - Open your web browser and navigate to the Argo CD UI at `https://argocd.management.ezbooking.lk`.
   - Log in using the admin credentials stored in the environment's `secrets.tf` file.
3. **Verify Application Deployment**:
   - In the Argo CD UI, navigate to the Applications section.
   - Locate the newly created application for the respective environment.
   - Check the sync status and health of the application to ensure it has been deployed successfully.
4. **Configure Overlays for New Environments**:
   - If you are setting up a new environment, create a new overlay folder under `overlays` in the `helabooking-manifests` repository.
   - Add the necessary Kustomize manifests specific to the new environment.
5. **Verify Sync and Health**:
   - After making changes, ensure that the application is in sync and healthy by checking the Argo CD UI.
   - If there are any issues, refer to the logs and troubleshoot accordingly.
